<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" href="../stylesheets/common.css" />
<link rel="stylesheet" href="../stylesheets/style.css" />

<title>元数据</title>
</head>
<body>
<div class="screen">
	﻿<div class="header">
	<div class="online_state">
		
	</div>
	<div class="logo">
		<a href="/"><img src="http://blog.yutouxiuxiu.com//images/logo.png" /></a>
	</div>
	<div class="description">
		芋家修修的技术博客 java,php,android,mysql,oracle,linux,mcu...
	</div>
</div>

	<div class="center">
		<div class="main">
		<div id="" class="post-home">
	<div class="post-title">
		<h2>
			<a rel="bookmark" href="">
				元数据
			</a>
		</h2>
		<span class="post-time">
			{ post:time }
		</span>
	</div>
	<div class="post-content">
		<h5><font style="font-weight: bold"><a href="http://localhost:8080/wp-content/uploads/2013/08/5c5e21d846d2.jpg"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="元数据" border="0" alt="元数据" src="http://localhost:8080/wp-content/uploads/2013/08/thumb1.jpg" width="452" height="484" /></a></font></h5>  <h5><font style="font-weight: bold">零、什么是元数据</font></h5>  <p>就是数据库、表、字段的定义信息</p>  <p>元数据是给框架用的 为了让框架可以获取到用户要操作数据库的信息</p>  <h5><font style="font-weight: bold">一、<strong>数据库元数据 </strong>DatabaseMetaDate</font></h5>  <p>&#160;</p>  <blockquote>   <p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; conn = dataSource.getConnection();      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; // 利用连接对象可以获取代表数据库基本信息的元数据对象       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; // 元数据是给框架用的 框架需要获取使用者的一些信息       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; DatabaseMetaData metaData = conn.getMetaData();       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; // 1.可以获取数据库的url信息       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; String url = metaData.getURL();&#160;&#160;&#160; //这个元数据是给框架用的 它不知道你的url 它就用这个来获取       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; System.out.println(url);       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; // 2.可以获取连接数据库的用户名       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; String username = metaData.getUserName();       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; System.out.println(username);       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; // 3.获取数据库驱动的名称       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; String driverName = metaData.getDriverName();       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; System.out.println(driverName);       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; /**       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; * 结果：       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; * jdbc:mysql://localhost:3306/test       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; * root@localhost       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; * MySQL-AB JDBC Driver       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; */       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; // 4.返回指定表主键的结果集       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; //metaData.getPrimaryKeys(catalog, schema, table)       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; //catalog: 类别名称 用于缩小搜索范围 不要缩小为null       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; //schema: 模式名称&#160; 用于缩小搜索范围 不要缩小为null       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; //table: 表名称       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; /* 每个主键列描述都有以下列：       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; TABLE_CAT String =&gt; 表类别（可为 null）       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; TABLE_SCHEM String =&gt; 表模式（可为 null）       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; TABLE_NAME String =&gt; 表名称       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; COLUMN_NAME String =&gt; 列名称       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; KEY_SEQ short =&gt; 主键中的序列号（值 1 表示主键中的第一列，值 2 表示主键中的第二列）。       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; PK_NAME String =&gt; 主键的名称（可为 null） */</p>    <p><strong>参见</strong></p>    <p><a title="http://localhost:8080/javaapi/java/sql/DatabaseMetaData.html#getPrimaryKeys%28java.lang.String,%20java.lang.String,%20java.lang.String%29" href="/javaapi/java/sql/DatabaseMetaData.html#getPrimaryKeys%28java.lang.String,%20java.lang.String,%20java.lang.String%29">/javaapi/java/sql/DatabaseMetaData.html#getPrimaryKeys%28java.lang.String,%20java.lang.String,%20java.lang.String%29</a>       <br />&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; rs = metaData.getPrimaryKeys(null, null, &quot;account&quot;);       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; while (rs.next()) {       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; String name = rs.getString(&quot;COLUMN_NAME&quot;);       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; short line = rs.getShort(&quot;KEY_SEQ&quot;);       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; System.out.println(line + &quot;:&quot; + name);       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; // 5.获取表的信息       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; //metaData.getTables(catalog, schemaPattern, tableNamePattern, types)       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; //catalog - 类别名称；它必须与存储在数据库中的类别名称匹配；该参数为 &quot;&quot; 表示获取没有类别的那些描述；为 null 则表示该类别名称不应该用于缩小搜索范围       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; //schemaPattern - 模式名称的模式；它必须与存储在数据库中的模式名称匹配；该参数为 &quot;&quot; 表示获取没有模式的那些描述；为 null 则表示该模式名称不应该用于缩小搜索范围       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; //tableNamePattern - 表名称模式；它必须与存储在数据库中的表名称匹配       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; //types - 要包括的表类型所组成的列表，必须取自从getTableTypes() 返回的表类型列表；null 表示返回所有类型&#160; </p>    <p><strong>参见</strong></p>    <p><a href="/javaapi/java/sql/DatabaseMetaData.html#getTables(java.lang.String, java.lang.String, java.lang.String, java.lang.String[])">/javaapi/java/sql/DatabaseMetaData.html#getTables(java.lang.String, java.lang.String, java.lang.String, java.lang.String[])</a>       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; rs = metaData.getTables(null, null, &quot;wp_%&quot;, new String[]{&quot;TABLE&quot;});&#160;&#160;&#160; //搜索以wp_前缀开头的表       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; while (rs.next()) {       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; String name = rs.getString(&quot;TABLE_NAME&quot;);       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; System.out.println(name);       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</p> </blockquote>  <p>&#160;</p>  <h5><font style="font-weight: bold">二、参数元数据 ParameterMetaData</font></h5>  <p>&#160;</p>  <blockquote>   <p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; conn = dataSource.getConnection();      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ps = conn.prepareStatement(&quot;SELECT * FROM account WHERE name=? money=?&quot;);       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; //获取参数元数据       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ParameterMetaData metaData = ps.getParameterMetaData();       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; // 1.获取参数个数       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; int count = metaData.getParameterCount();&#160;&#160;&#160; //框架用它来获取用户给框架传的SQL语句中有多少参数       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; // 2.获取参数类型       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; for (int i = 1; i &lt;= count; i++) {       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; metaData.getParameterTypeName(i);       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; //但是mysql数据库不支持这个方法（getParameterType异常）       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; //可以在连接url后面拼接&quot;?generateSimpleParameterMetadata=true&quot;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; //但是无论是什么类型 都会返回VARCHAR       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; //（注意！！！）在mysql里这个方法没有用！       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</p> </blockquote>  <p>&#160;</p>  <h5><font style="font-weight: bold">三、结果集元数据 ResultSetMetaData</font></h5>  <p>&#160;</p>  <blockquote>   <p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; conn = dataSource.getConnection();      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ps = conn.prepareStatement(&quot;SELECT * FROM account WHERE name=? money=?&quot;);       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ps.setString(1, &quot;aaa&quot;);       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ps.setDouble(2, 50.0);       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; rs = ps.executeQuery();       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; // 获取结果集元数据       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ResultSetMetaData metaData = rs.getMetaData();       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; // 1.获取有多少字段       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; int count = metaData.getColumnCount();       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; // 2.获取指定字段的名称       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; String name = metaData.getColumnName(1);       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; // 3.获取指定字段的类型       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; String type = metaData.getColumnTypeName(1);       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; /**       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; * 结果       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; * 3       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; * id       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; * INT       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; */</p></blockquote>
	</div>
</div>

		</div>
		<div class="sidebar">
		<div id="" class="sidebar">
	<div id="csidebar">
		<ul>
			<li class="widget widget_recent_entries">
				<h3>分类目录</h3>
				<ul>
					
						<li><a href="http://blog.yutouxiuxiu.com/terms/term_1.html" style="padding-left:4;">未分类</a></li>
					
						<li><a href="http://blog.yutouxiuxiu.com/terms/term_2.html" style="padding-left:4;">Java基础</a></li>
					
						<li><a href="http://blog.yutouxiuxiu.com/terms/term_4.html" style="padding-left:8;">集合</a></li>
					
						<li><a href="http://blog.yutouxiuxiu.com/terms/term_3.html" style="padding-left:4;">Web基础</a></li>
					
						<li><a href="http://blog.yutouxiuxiu.com/terms/term_5.html" style="padding-left:8;">XML</a></li>
					
						<li><a href="http://blog.yutouxiuxiu.com/terms/term_9.html" style="padding-left:8;">Servlet</a></li>
					
						<li><a href="http://blog.yutouxiuxiu.com/terms/term_16.html" style="padding-left:8;">JSP</a></li>
					
						<li><a href="http://blog.yutouxiuxiu.com/terms/term_6.html" style="padding-left:4;">面试</a></li>
					
						<li><a href="http://blog.yutouxiuxiu.com/terms/term_7.html" style="padding-left:4;">软件使用</a></li>
					
						<li><a href="http://blog.yutouxiuxiu.com/terms/term_8.html" style="padding-left:8;">WordPress</a></li>
					
						<li><a href="http://blog.yutouxiuxiu.com/terms/term_10.html" style="padding-left:4;">HTML</a></li>
					
						<li><a href="http://blog.yutouxiuxiu.com/terms/term_11.html" style="padding-left:8;">JavaScript</a></li>
					
						<li><a href="http://blog.yutouxiuxiu.com/terms/term_12.html" style="padding-left:8;">css</a></li>
					
						<li><a href="http://blog.yutouxiuxiu.com/terms/term_13.html" style="padding-left:4;">小案例</a></li>
					
						<li><a href="http://blog.yutouxiuxiu.com/terms/term_14.html" style="padding-left:8;">Servlet小案例</a></li>
					
						<li><a href="http://blog.yutouxiuxiu.com/terms/term_15.html" style="padding-left:8;">HTML小案例</a></li>
					
						<li><a href="http://blog.yutouxiuxiu.com/terms/term_17.html" style="padding-left:4;">分类总结</a></li>
					
						<li><a href="http://blog.yutouxiuxiu.com/terms/term_18.html" style="padding-left:4;">项目进度</a></li>
					
						<li><a href="http://blog.yutouxiuxiu.com/terms/term_19.html" style="padding-left:4;">数据库</a></li>
					
						<li><a href="http://blog.yutouxiuxiu.com/terms/term_20.html" style="padding-left:8;">MySQL</a></li>
					
						<li><a href="http://blog.yutouxiuxiu.com/terms/term_23.html" style="padding-left:8;">JDBC</a></li>
					
						<li><a href="http://blog.yutouxiuxiu.com/terms/term_25.html" style="padding-left:12;">测试</a></li>
					
						<li><a href="http://blog.yutouxiuxiu.com/terms/term_24.html" style="padding-left:8;">SQL</a></li>
					
						<li><a href="http://blog.yutouxiuxiu.com/terms/term_21.html" style="padding-left:4;">项目开发经验</a></li>
					
						<li><a href="http://blog.yutouxiuxiu.com/terms/term_22.html" style="padding-left:4;">千奇百怪问题库</a></li>
					
				</ul>
			</li>
		</ul>
</div>

		</div>
	</div>
	<div class="footer">
	<div class="copyright">© 2013 芋头修修家 版权所有</div>
</div>

</div>
</body>
</html>
